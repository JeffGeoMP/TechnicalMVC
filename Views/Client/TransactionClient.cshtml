@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
    @model TechnicalMVC.Models.Entities.Client;
}

<div>
    <div class="card">
        <div class="card-header">
            @if(Model != null)
            {
                <h4 class="card-title">Editar Cliente</h4>
            }
            else
            {
                <h4 class="card-title">Agregar Cliente</h4>
            }
            
        </div>
        <div class="card-body">
            <div class="row mb-3">
                <label for="input-name-client" class="col-md-4 col-form-label">Ingrese el Nombre del Cliente: </label>
                <div class="col-md-8">
                    <input id="input-name-client" "type="numer" class="form-control" placeholder="Nombre" asp-for="Name">
                </div>
            </div>
            <div class="row mb-3">
                <label for="input-dpi-client" class="col-md-4 col-form-label">Ingrese el DPI del Cliente: </label>
                <div class="col-md-8">
                    <input id="input-dpi-client" "type=" number" class="form-control" placeholder="DPI" value="Model.DPI ?? string.Empty">
                </div>
            </div>
            <div class="row mb-3">
                <label for="input-nit-client" class="col-md-4 col-form-label">Ingrese el NIT del Cliente: </label>
                <div class="col-md-8">
                    <input id="input-nit-client" "type=" text" class="form-control" placeholder="NIT" value="Model.NIT ?? string.Empty">
                </div>
            </div>
            <div class="row mb-3">
                <label for="input-address-client" class="col-md-4 col-form-label">Ingrese la Dirección del Cliente: </label>
                <div class="col-md-8">
                    <input id="input-address-client" "type=" text" class="form-control" placeholder="Dirección" value="Model.Address ?? string.Empty">
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-12">
                    <button type="button" class="btn btn-outline-primary" onclick="saveClient()"><i class="fas fa-save"></i> Guardar</button>
                </div>
        </div>
    </div>
</div>


<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/notiflix/dist/notiflix-3.2.7.min.js"></script>

<script>
    function saveClient(){
            var client = {
            Id: Model == null ? 0 : Model.Id,
            Name: $('#input-name-client').val(),
            DPI: $('#input-dpi-client').val(),
            NIT: $('#input-nit-client').val(),
            Address: $('#input-address-client').val()
        };

        Notiflix.Loading.pulse('Guardando Cliente');

        $.ajax({
            url: '@ViewBag.ApplicationURL/client/saveclient',
            type: 'POST',
            dataType: 'json',
            contentType: 'application/json',
            data: JSON.stringify(client),
            success: function (data) {
                Notiflix.Notify.Success('Cliente Guardado');
            },
            Error: function (error) {
                Notiflix.Notify.Failure('Error al guardar el cliente: ' + error);
            },
            complete: function () {
                Notiflix.Loading.remove();
            }
        });
    }
</script>